webpackJsonp([1],{"2Q0k":function(e,t){},"Lg6+":function(e,t){},NHnr:function(e,t,n){"use strict";function i(){var e=d.getWorldDirection();e.multiplyScalar(.3),y[87]&&d.position.add(e),y[65],y[83]&&d.position.add(e.multiplyScalar(-1)),y[68],d.setRotationFromQuaternion(new s.h(0,0,0,1)),d.rotateOnWorldAxis(new s.m(1,0,0),v),d.rotateOnWorldAxis(new s.m(0,1,0),m),a.render(l,d),window.requestAnimationFrame(_)}function o(e){L&&(m-=e.movementX/1e3,v-=e.movementY/1e3),L=e.offsetX,e.offsetY}Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),s=n("Ml+6"),a=void 0,l=void 0,d=void 0,c=void 0,u=void 0,h=void 0,v=-.8,m=0,f=[],p=new s.i,w=void 0,g=void 0,_=i,y=[],L=void 0,b={props:["world","selected"],watch:{world:function(e){!function(e){f=[],(d=new s.g(70,1,1,1e3)).position.z=50,d.position.y=50,d.rotation.x=-.8,l=new s.j;var t=new s.b(.2,.2,.2),n=new s.b(1,1,1),i=new s.b(2,2,2),o=new s.f({color:16777215,shading:s.k}),r=new s.f({color:16716049,shading:s.k}),a=new s.f({color:1179409,shading:s.k});g=new s.f({color:16776977,shading:s.k}),(u=new s.c(16777181,.5)).position.set(-10,300.75,500),l.add(u),h=new s.a(16777215,.5),l.add(h),c=new s.d,e.things.forEach(function(e){var l=void 0;(l=0===e.type.indexOf("StructureFrame",0)?new s.e(i,o):e.parent?new s.e(t,a):new s.e(n,r)).position.x=e.pos.x,l.position.y=e.pos.y,l.position.z=e.pos.z,c.add(l),e.mesh=l,f[e.mesh.uuid]=e}),l.add(c)}(e),window.requestAnimationFrame(i),!0},selected:function(e,t){t.mesh&&(t.mesh.material=w),w=e.mesh.material,e.mesh.material=g,t=e}},mounted:function(){window.onkeyup=function(e){y[e.keyCode]=!1},window.onkeydown=function(e){y[e.keyCode]=!0},(a=new s.n).setPixelRatio(window.devicePixelRatio),a.setSize(600,600),this.$el.appendChild(a.domElement),a.domElement.oncontextmenu=function(e){return!1},a.domElement.onmousedown=function(e){if(2===e.button)a.domElement.requestPointerLock(),document.addEventListener("mousemove",o,!1);else if(0===e.button){var t=new s.l(e.offsetX/e.target.clientWidth*2-1,-e.offsetY/e.target.clientHeight*2+1);console.log(t),p.setFromCamera(t,d);var n=p.intersectObjects(c.children);n.length&&document.bus.$emit("thing-selected",f[n[0].object.uuid])}return!1},a.domElement.onmouseup=function(e){return document.exitPointerLock(),document.removeEventListener("mousemove",o,!1),!1}}},x={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"level-view"})},staticRenderFns:[]},S=n("VU/8")(b,x,!1,function(e){n("i0r/")},"data-v-0b231b80",null).exports,T=n("Zrlr"),k=n.n(T),E=n("wxAW"),F=n.n(E),M=function(){function e(){k()(this,e)}return F()(e,null,[{key:"createWorldFromXML",value:function(e){var t={};t.dom=e,t.things=[];var n=e.querySelectorAll("ThingSaveData");return n.forEach(function(e){var n=e.querySelector("WorldPosition"),i=e.querySelector("CustomName"),o={id:1*e.querySelector("ReferenceId").innerHTML,dom:e,type:e.querySelector("PrefabName").innerHTML,name:i.innerHTML,pos:{x:1*n.querySelector("x").innerHTML,y:1*n.querySelector("y").innerHTML,z:1*n.querySelector("z").innerHTML},children:[]};t.things[o.id]=o}),t.things.forEach(function(e){var n=e.dom.querySelector("ParentReferenceId");n&&(e.parent=t.things[n.innerHTML],e.parent&&t.things[n.innerHTML].children.push(e))}),t.title=n.length+" loaded things.",t}}]),e}(),W={props:["world"],data:function(){return{loadWorld:function(e){var t=e.target,n=t.files[0],i=new FileReader;n&&(i.onload=function(e){var n=(new DOMParser).parseFromString(e.target.result,"text/xml"),i=M.createWorldFromXML(n);document.bus.$emit("world-loaded",i),t.value=""},i.readAsText(n))},saveWorld:function(){new XMLSerializer}}}},C={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"loadsave"}},[t("label",{staticClass:"button"},[t("input",{attrs:{type:"file",name:"file"},on:{change:this.loadWorld}}),this._v("\n    Load World\n  ")]),this._v(" "),t("div",{staticClass:"button",on:{click:this.saveWorld}},[this._v("\n    Save Copy of World\n  ")]),this._v(" "),t("div",[this.world?t("h3",[this._v(this._s(this.world.title))]):this._e()])])},staticRenderFns:[]},H=n("VU/8")(W,C,!1,function(e){n("TUn+")},"data-v-68356df6",null).exports,q={props:["things","title"],methods:{select:function(e){document.bus.$emit("thing-selected",e)}}},R={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"thing-list"},e._l(e.things,function(t){return n("li",{staticClass:"thing-item",on:{click:function(n){e.select(t)}}},[e._v("\n    "+e._s(t.name||t.type)+"\n  ")])}))},staticRenderFns:[]},$=n("VU/8")(q,R,!1,function(e){n("eBLH")},"data-v-3a0976d0",null).exports,P={props:["thing"],components:{ThingList:$}},A={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"inspector"},[t("h3",[this._v(this._s(this.thing.name))]),this._v(" "),t("ul",[t("li",[this._v(this._s(this.thing.type))]),this._v(" "),t("li",[this._v(this._s(this.thing.pos))])]),this._v(" "),t("h5",[this._v("Contents:")]),this._v(" "),t("ThingList",{attrs:{things:this.thing.children}})],1)},staticRenderFns:[]},z=n("VU/8")(P,A,!1,function(e){n("Lg6+")},"data-v-9320631e",null).exports,O=n("M4fF"),U={name:"app",data:function(){return{world:{},selected:{}}},computed:{players:function(){return Object(O.filter)(this.world.things,function(e){return e&&"Character"===e.type})}},created:function(){var e=this;document.bus.$on("world-loaded",function(t){e.world=t}),document.bus.$on("thing-selected",function(t){e.selected=t})},components:{LevelView3D:S,LevelLoadSave:H,ThingList:$,ThingInspector:z}},V={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{attrs:{id:"left-panel"}},[t("LevelLoadSave",{attrs:{world:this.world}}),this._v(" "),t("h3",[this._v("Players:")]),this._v(" "),t("ThingList",{attrs:{things:this.players}})],1),this._v(" "),t("div",{attrs:{id:"center"}},[t("LevelView3D",{attrs:{world:this.world,selected:this.selected}})],1),this._v(" "),t("div",{attrs:{id:"right-panel"}},[t("ThingInspector",{attrs:{thing:this.selected}})],1)])},staticRenderFns:[]},X=n("VU/8")(U,V,!1,function(e){n("2Q0k")},null,null).exports;r.a.config.productionTip=!1,document.bus=new r.a,new r.a({el:"#app",template:"<App/>",components:{App:X}})},"TUn+":function(e,t){},eBLH:function(e,t){},"i0r/":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2b0a0f15857e548c52c0.js.map