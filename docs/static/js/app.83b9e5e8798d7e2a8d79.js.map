{"version":3,"sources":["webpack:///src/components/LevelView3D.vue","webpack:///./src/components/LevelView3D.vue?55c8","webpack:///src/components/LevelLoadSave.vue","webpack:///./src/components/LevelLoadSave.vue?7e4c","webpack:///src/App.vue","webpack:///./src/components/LevelView3D.vue","webpack:///./src/components/LevelLoadSave.vue","webpack:///./src/App.vue?92ca","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["LevelView3D","getWorldDirection","forward","rotX","rotY","camera","renderFunc","offsetX","offsetY","didSetup","ambLight","this","render","domElement","three_module","devicePixelRatio","requestPointerLock","exitPointerLock","dirLight","mesh","whiteMat","redMat","x","y","z","levelGroup","world","components_LevelView3D","_h","$createElement","_self","_c","staticClass","staticRenderFns","LevelLoadSave","undefined","target","FileReader","DOMParser","dom","thing","innerHTML","refresh","obj","file","XMLSerializer","components_LevelLoadSave","attrs","id","type","name","on","change","loadWorld","_v","click","saveWorld","_s","title","_e","App","__webpack_require__","normalizeComponent","ssrContext","LevelLoadSave_normalizeComponent","selectortype_template_index_0_src_App","src_App","App_normalizeComponent","vue_esm","config","productionTip","document","bus","el","template","components"],"mappings":"6KAOAA,QAEA,sDAeAC,qCAEA,0BAGAC,6CAIA,uCACAC,sCAGAC,cACAC,gCACAC,oCAMA,mBACA,SAGAC,UACAC,YAvCAC,OAAA,+CACAC,OAAA,IAEAC,8GAMA,IAEAC,8EAkGAC,0CAjEA,iBACA,gBAEA,iBAEA,SACAC,EAAA,oBACA,iBACA,qCACAA,EAAA,sCAEAA,EAAA,WACAA,EAAA,wBACAC,gCACA,yBAEAF,0DAGA,2EAIAG,8DACA,KAEA,sDAGAC,8DACA,IACA,uBAGA,6BACA,WAEAC,sBACA,UAEAR,SAEAI,EAAA,mCAGAK,OAAA,sDAEAC,aAEAC,qBAGAC,qBACAC,qBAEAC,QACAL,WAGAM,IAUAC,gCACAd,MACA,MC3HAe,GADiBf,OAFjB,WAA0B,IAAagB,EAAbjB,KAAakB,eAAkD,OAA/DlB,KAAuCmB,MAAAC,IAAAH,GAAwB,OAAiBI,YAAA,YAEzFC,oBCcjBC,QAEA,yCAEAvB,yDAEAe,uCAKAS,qCAIAC,iBACA,SAEAC,+CAIAC,2CAEA,kBACAC,uCAKA,kDAKAC,iEAGAC,oCACA,0BAEA,mCACA,mCAEA,qCAGAC,wBACAC,sBAKA,oDAEAjB,WACA,iBAGAkB,8BAGAC,kBC3EAC,GADiBlC,OAFjB,WAA0B,IAAagB,EAAbjB,KAAakB,eAA0BE,EAAvCpB,KAAuCmB,MAAAC,IAAAH,EAAwB,OAAAG,EAAA,OAAiBgB,OAAOC,GAAA,cAAiBjB,EAAA,SAAcC,YAAA,WAAqBD,EAAA,SAAcgB,OAAOE,KAAA,OAAAC,KAAA,QAA4BC,IAAKC,OAAjMzC,KAAiM0C,aAAjM1C,KAAyN2C,GAAA,0BAAzN3C,KAAyN2C,GAAA,KAAAvB,EAAA,OAAyDC,YAAA,SAAAmB,IAAyBI,MAA3S5C,KAA2S6C,aAA3S7C,KAAkU2C,GAAA,kCAAlU3C,KAAkU2C,GAAA,KAAAvB,EAAA,OAAlUpB,KAAkU,MAAAoB,EAAA,MAAlUpB,KAAkU2C,GAAlU3C,KAAkU8C,GAAlU9C,KAAkUe,MAAAgC,UAAlU/C,KAAkUgD,UAE3U1B,oBCSjB2B,QAEA,kBAEA5D,YCZA6D,EAAA,OAcAC,CACA9D,EACA2B,GATA,EAVA,SAAAoC,GACAF,EAAA,SAaA,kBAEA,MAUA,QDTA3B,cEdA2B,EAAA,OAcAG,CACA9B,EACAY,GATA,EAVA,SAAAiB,GACAF,EAAA,SAaA,kBAEA,MAUA,UCvBAI,GADiBrD,OAFjB,WAA0B,IAAagB,EAAbjB,KAAakB,eAA0BE,EAAvCpB,KAAuCmB,MAAAC,IAAAH,EAAwB,OAAAG,EAAA,OAAiBgB,OAAOC,GAAA,SAAYjB,EAAA,iBAAnGpB,KAAmG2C,GAAA,KAAAvB,EAAA,oBAE5GE,oBCwBjBiC,EAvBAL,EAAA,OAcAM,CACAP,EACAK,GATA,EAVA,SAAAF,GACAF,EAAA,SAaA,KAEA,MAUA,QCrBAO,EAAA,EAAIC,OAAOC,eAAgB,EAE3BC,SAASC,IAAM,IAAIJ,EAAA,EAGnB,IAAIA,EAAA,GACFK,GAAI,OACJC,SAAU,SACVC,YAAcf,IAAAM","file":"static/js/app.83b9e5e8798d7e2a8d79.js","sourcesContent":["<template>\n\t<div class=\"view3d\"></div>\n</template>\n\n<script>\nimport {Scene, PerspectiveCamera, WebGLRenderer, BoxBufferGeometry, MeshPhongMaterial, Mesh, SmoothShading, DirectionalLight, AmbientLight, Group, Quaternion, Vector3} from 'three';\n\nexport default {\n  name: 'LevelView3D',\n  mounted: function() {\n    let didSetup;\n    let renderer, scene, camera, levelGroup, dirLight, ambLight;\n    let vm = this;\n\n    let keys = [];\n    window.onkeyup = function(e) {keys[e.keyCode]=false;}\n    window.onkeydown = function(e) {keys[e.keyCode]=true;}\n\n    let rotX = 0, rotY = 0;\n\n    let renderFunc = render;\n\n    function render() {\n      let forward = camera.getWorldDirection();\n      forward.multiplyScalar(0.1);\n\n      // Get keys\n      if (keys[87]) { // W\n        camera.position.add(forward);\n      }\n\n      // Update camera rotation\n      camera.setRotationFromQuaternion(new Quaternion(0, 0, 0, 1));\n      camera.rotateOnWorldAxis(new Vector3(1, 0, 0), rotX);\n      camera.rotateOnWorldAxis(new Vector3(0, 1, 0), rotY);\n\n\n      renderer.render( scene, camera );\n      window.requestAnimationFrame(renderFunc);\n    }\n\n    let oldX, oldY;\n    function mouseMove(ev) {\n      if (oldX) {\n        rotY -= ev.movementX / 1000;\n        rotX -= ev.movementY / 1000;\n      }\n\n      oldX = ev.offsetX;\n      oldY = ev.offsetY;\n    }\n\n    function init(world) {\n      camera = new PerspectiveCamera( 70, 1, 1, 1000 );\n      \n      camera.position.z = 50;\n      camera.position.y = 50;\n\n      camera.rotation.x = -0.8;\n\n      scene = new Scene();\n      let geometry = new BoxBufferGeometry( 1, 1, 1 );\n      let bigGeo = new BoxBufferGeometry( 2, 2, 2 );\n      let whiteMat = new MeshPhongMaterial( { color: 0xffffff, shading: SmoothShading } );\n      let redMat = new MeshPhongMaterial( { color: 0xff1111, shading: SmoothShading } );\n\n      renderer = new WebGLRenderer();\n      renderer.setPixelRatio( window.devicePixelRatio );\n      renderer.setSize( 600, 600 );\n      vm.$el.appendChild( renderer.domElement );\n\n      // Set up mouse locking\n      renderer.domElement.oncontextmenu = function (ev) {\n        return false;\n      }\n      renderer.domElement.onmousedown = function (ev) {\n        if (ev.button === 2) {\n          renderer.domElement.requestPointerLock();\n          document.addEventListener(\"mousemove\", mouseMove, false);\n        }\n        return false;\n      };\n      renderer.domElement.onmouseup = function (ev) {\n        document.exitPointerLock();\n        document.removeEventListener(\"mousemove\", mouseMove, false);\n        return false;\n      };\n\n      dirLight = new DirectionalLight( 0xffffdd, 0.5 );\n      dirLight.position.set( -10, 300.75, 500 );\n      scene.add( dirLight );\n\n      ambLight = new AmbientLight( 0xffffff, 0.5 );\n      scene.add( ambLight );\n\n      levelGroup = new Group();\n\n      world.things.forEach((thing) => {\n        let mesh;\n        \n        if (thing.type.indexOf('StructureFrame', 0) === 0) {\n          mesh = new Mesh( bigGeo, whiteMat );\n        } else {\n          mesh = new Mesh( geometry, redMat );\n        }\n\n        mesh.position.x = thing.pos.x;\n        mesh.position.y = thing.pos.y;\n        mesh.position.z = thing.pos.z;\n\n        levelGroup.add(mesh);\n      });\n\n      scene.add(levelGroup);\n    }\n\n    document.bus.$on(\"world-loaded\", (world) => {\n      // Cleanup\n      if (didSetup) {\n        vm.$el.removeChild( renderer.domElement );\n      }\n\n      init(world);\n\n      window.requestAnimationFrame(render);\n      didSetup = true;\n    });\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/LevelView3D.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"view3d\"})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-137c8518\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/LevelView3D.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"loadsave\">\n    <label class=\"button\">\n      <input type=\"file\" name=\"file\" @change=\"loadWorld\">\n      Load World\n    </label>\n    <div class=\"button\" @click=\"saveWorld\">\n      Save Copy of World\n    </div>\n    <div>\n      <h3 v-if=\"world\">{{world.title}}</h3>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'LevelLoadSave',\n  created () {\n    var vm = this;\n    document.bus.$on(\"world-loaded\", (world) => {\n      vm.world = world;\n    });\n  },\n  data () {\n    return {\n      world: undefined,\n      loadWorld (el) {\n        var world = {};\n        \n        var input = el.target;\n        var file = input.files[0];\n        var reader = new FileReader();\n\n        if (!file) return;\n\n        reader.onload = function(ev) {\n          var parse = new DOMParser();\n          var dom = parse.parseFromString(ev.target.result, \"text/xml\");\n          \n          world.dom = dom;\n          world.things = [];\n\n          // Process all the things\n          var things = dom.querySelectorAll(\"ThingSaveData\");\n          \n          things.forEach(function(thing) { \n            var obj = {\n              dom: thing\n            }\n\n            obj.refresh = function() {\n              obj.type = obj.dom.querySelector(\"PrefabName\").innerHTML;\n\n              var pos = obj.dom.querySelector(\"WorldPosition\");\n              obj.pos = { \n                x: pos.querySelector(\"x\").innerHTML * 1, \n                y: pos.querySelector(\"y\").innerHTML * 1, \n                z: pos.querySelector(\"z\").innerHTML * 1\n              };\n            }\n            obj.refresh();\n\n            world.things.push(obj);\n          });\n\n          world.title = things.length + \" loaded things.\";\n\n\n          document.bus.$emit(\"world-loaded\", world);\n\n          input.value = \"\";\n        }\n\n        reader.readAsText(file);\n      },\n      saveWorld () {\n          var ser = new XMLSerializer();\n          // TODO: Change this to download a file\n          //document.querySelector(\"#out\").value = ser.serializeToString(dom);\n      }\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n#loadsave {\n  margin: 20px;\n}\n\ninput[type=file] {\n  display: none;\n}\n\n.button {\n  display: inline-block;\n  padding: 5px 10px;\n\n  background-color: #e77;\n  border: 3px solid #c11;\n\n  color: white;\n  font-weight: bolder;\n  font-size: 16pt;\n  \n  user-select: none;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/LevelLoadSave.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"loadsave\"}},[_c('label',{staticClass:\"button\"},[_c('input',{attrs:{\"type\":\"file\",\"name\":\"file\"},on:{\"change\":_vm.loadWorld}}),_vm._v(\"\\n    Load World\\n  \")]),_vm._v(\" \"),_c('div',{staticClass:\"button\",on:{\"click\":_vm.saveWorld}},[_vm._v(\"\\n    Save Copy of World\\n  \")]),_vm._v(\" \"),_c('div',[(_vm.world)?_c('h3',[_vm._v(_vm._s(_vm.world.title))]):_vm._e()])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1e92b334\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/LevelLoadSave.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <LevelLoadSave />\n    <LevelView3D />\n  </div>\n</template>\n\n<script>\nimport LevelView3D from './components/LevelView3D';\nimport LevelLoadSave from './components/LevelLoadSave';\n\nexport default {\n  name: 'app',\n  components: {\n    LevelView3D,\n    LevelLoadSave\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-137c8518\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./LevelView3D.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LevelView3D.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LevelView3D.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-137c8518\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./LevelView3D.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-137c8518\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/LevelView3D.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1e92b334\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./LevelLoadSave.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LevelLoadSave.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./LevelLoadSave.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1e92b334\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./LevelLoadSave.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1e92b334\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/LevelLoadSave.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('LevelLoadSave'),_vm._v(\" \"),_c('LevelView3D')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2ffa9579\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2ffa9579\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2ffa9579\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\nVue.config.productionTip = false\n\ndocument.bus = new Vue()\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  template: '<App/>',\n  components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}